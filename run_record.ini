include omnetpp.ini

[General]
# --- ضبط خروجی برای همه‌ی ماژول‌ها ---
output-scalar-file = results/${configname}-${runnumber}.sca
output-vector-file = results/${configname}-${runnumber}.vec
**.scalar-recording = true
**.vector-recording = true
**.result-recording-modes = all

# --- زمان اجرا و تصادفی‌سازی (برای تکرارپذیری) ---
sim-time-limit = 10s
rng-class = "cMersenneTwister"
num-rngs = 1
seed-set = 123

# --- پیش‌فرض‌های معقول (در هر کانفیگ اگر لازم بود override می‌کنیم) ---
network = ned.LightIoTNetwork
**.fakeNode.enabled = false            # پیش‌فرض: حمله خاموش
**.gateway.batteryInit_mJ = 5000
**.gateway.costForward_mJ  = 5
**.gateway.costVerify_mJ   = 5
**.gateway.procDelay       = 1ms
**.gateway.hmacWindow      = 1s


# ============================
#       Secure (5/20/50)
# ============================
[Config Secure5_record]
LightIoTNetwork.numSensorNodes = 5
**.fakeNode.enabled       = false
**.gateway.securityEnabled = true
**.gateway.procDelay       = 1ms
**.gateway.costVerify_mJ   = 5
**.gateway.hmacWindow      = 1s

[Config Secure20_record]
LightIoTNetwork.numSensorNodes = 20
**.fakeNode.enabled       = false
**.gateway.securityEnabled = true
**.gateway.procDelay       = 1ms
**.gateway.costVerify_mJ   = 5
**.gateway.hmacWindow      = 1s

[Config Secure50_record]
LightIoTNetwork.numSensorNodes = 50
**.fakeNode.enabled       = false
**.gateway.securityEnabled = true
**.gateway.procDelay       = 1ms
**.gateway.costVerify_mJ   = 5
**.gateway.hmacWindow      = 1s


# ============================
#        No Security
# ============================
[Config NoSec5_record]
LightIoTNetwork.numSensorNodes = 5
**.fakeNode.enabled       = false
**.gateway.securityEnabled = false
**.gateway.procDelay       = 0s
**.gateway.costVerify_mJ   = 0     # بدون هزینه‌ی Verify

[Config NoSec20_record]
LightIoTNetwork.numSensorNodes = 20
**.fakeNode.enabled       = false
**.gateway.securityEnabled = false
**.gateway.procDelay       = 0s
**.gateway.costVerify_mJ   = 0

[Config NoSec50_record]
LightIoTNetwork.numSensorNodes = 50
**.fakeNode.enabled       = false
**.gateway.securityEnabled = false
**.gateway.procDelay       = 0s
**.gateway.costVerify_mJ   = 0


# ============================
#     Attack on Secure (Replay)
# ============================
[Config Attack5_record]
LightIoTNetwork.numSensorNodes = 5
**.fakeNode.enabled       = true
**.fakeNode.attackMode    = 1          # replay
**.fakeNode.replayInterval = 2.5s
**.gateway.securityEnabled = true
**.gateway.procDelay       = 1ms
**.gateway.costVerify_mJ   = 5
**.gateway.hmacWindow      = 1s

[Config Attack20_record]
LightIoTNetwork.numSensorNodes = 20
**.fakeNode.enabled       = true
**.fakeNode.attackMode    = 1
**.fakeNode.replayInterval = 2.5s
**.gateway.securityEnabled = true
**.gateway.procDelay       = 1ms
**.gateway.costVerify_mJ   = 5
**.gateway.hmacWindow      = 1s

[Config Attack50_record]
LightIoTNetwork.numSensorNodes = 50
**.fakeNode.enabled       = true
**.fakeNode.attackMode    = 1
**.fakeNode.replayInterval = 2.5s
**.gateway.securityEnabled = true
**.gateway.procDelay       = 1ms
**.gateway.costVerify_mJ   = 5
**.gateway.hmacWindow      = 1s


# =========================================
#  حساسیت 1: Attack روی NoSec (Replay عبور می‌کند)
# =========================================
[Config AttackOnNoSec50_record]
LightIoTNetwork.numSensorNodes = 50
**.fakeNode.enabled       = true
**.fakeNode.attackMode    = 1
**.fakeNode.replayInterval = 2.5s
**.gateway.securityEnabled = false
**.gateway.procDelay       = 0s
**.gateway.costVerify_mJ   = 0     # بدون Verify در NoSec

# =========================================
#  حساسیت 2: پنجره‌ی تازگی بزرگ‌تر (3s) روی Secure
#  (با ضدتکرار ID, تنها اولین replay ممکنه عبور کنه)
# =========================================
[Config Attack50_window3s_record]
LightIoTNetwork.numSensorNodes = 50
**.fakeNode.enabled       = true
**.fakeNode.attackMode    = 1
**.fakeNode.replayInterval = 2.5s
**.gateway.securityEnabled = true
**.gateway.procDelay       = 1ms
**.gateway.costVerify_mJ   = 5
**.gateway.hmacWindow      = 3s
# ============================
#     Ablation (Secure, 50)
# ============================
[Config Secure50_hmacOnly]
extends = Secure50_record
**.gateway.checkHmac = true
**.gateway.checkFreshness = false
**.gateway.checkDuplicate = false

[Config Secure50_freshOnly]
extends = Secure50_record
**.gateway.checkHmac = false
**.gateway.checkFreshness = true
**.gateway.checkDuplicate = false

[Config Secure50_dupOnly]
extends = Secure50_record
**.gateway.checkHmac = false
**.gateway.checkFreshness = false
**.gateway.checkDuplicate = true

# ============================
#           CI (repeat)
# ============================
[Config Secure50_CI]
extends = Secure50_record
repeat = 5
seed-set = ${repetition}

[Config NoSec50_CI]
extends = NoSec50_record
repeat = 5
seed-set = ${repetition}

[Config Attack50_CI]
extends = Attack50_record
repeat = 5
seed-set = ${repetition}

[Config Secure100_CI]
extends = Secure50_record
LightIoTNetwork.numSensorNodes = 100
repeat = 5
seed-set = ${repetition}

[Config NoSec100_CI]
extends = NoSec50_record
LightIoTNetwork.numSensorNodes = 100
repeat = 5
seed-set = ${repetition}

[Config Attack100_CI]
extends = Attack50_record
LightIoTNetwork.numSensorNodes = 100
repeat = 5
seed-set = ${repetition}